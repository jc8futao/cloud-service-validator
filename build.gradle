plugins {
	id 'org.springframework.boot' version '2.0.5.RELEASE'
  id 'com.github.sherter.google-java-format' version '0.7.1'
	id 'java'
}

apply plugin: 'java'
apply plugin: 'io.spring.dependency-management'

jar {
	baseName = 'playground'
	version =  '0.0.1-SNAPSHOT'
}

repositories {
	jcenter()
}

sourceSets {
    addtionals {
        java {
            srcDirs 'build/generated/source/apt/main'
        }
    }
}

configurations {
    systemTestCompile.extendsFrom testCompile
    systemTestRuntime.extendsFrom testRuntime
}

dependencies {
    compile fileTree(dir: 'libs', include:['*.jar'])

    compile ('io.lettuce:lettuce-core:5.1.0.RELEASE')
      compile ('org.mongodb:mongodb-driver:3.6.4')
         compile("org.springframework.boot:spring-boot-starter-web")
  compile("org.springframework.boot:spring-boot-starter-thymeleaf")
  compile("org.springframework.boot:spring-boot-starter-actuator")
	testCompile("org.springframework.boot:spring-boot-starter-test")

  // Use 'api' rather than 'compile' for Android or java-library projects.
  compile             "com.google.auto.value:auto-value-annotations:1.6.2"
  annotationProcessor "com.google.auto.value:auto-value:1.6.2"
}

bootJar {
    archiveName = "app.jar"
}

task codeTest(type: Test) {
    testClassesDirs = sourceSets.addtionals.output.classesDirs
    classpath = sourceSets.addtionals.runtimeClasspath
    outputs.upToDateWhen { false }
}

allprojects {
    repositories {
        google()
        jcenter()
        maven{
            url "https://maven.google.com"
        }
    }
}

check.dependsOn codeTest